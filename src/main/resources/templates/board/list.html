<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/tymeleaf/layout"
      layout:decorate="~{layout/layout}">

<div layout:fragment="content" class="container-md">
  <h1>Boot Board List Page</h1>
  <hr>
  <!-- 검색 폼 -->
  <div class="container-fluid" style="padding: 0;">
    <form action="/board/list" method="get" class="d-flex" role="search" id="searchForm">
      <!-- 검색 조건 -->
      <select class="form-select" name="type">
        <option th:selected="${ph.pgvo.type == null ? 'true' : 'false' }" > 선택하시오 </option>
        <option th:value="twc" th:selected="${ph.pgvo.type eq 'twc' ? 'true' : 'false' }">전체</option>
        <option th:value="t" th:selected="${ph.pgvo.type eq 't' ? 'true' : 'false' }">제목</option>
        <option th:value="w" th:selected="${ph.pgvo.type eq 'w' ? 'true' : 'false' }">작가</option>
        <option th:value="c" th:selected="${ph.pgvo.type eq 'c' ? 'true' : 'false' }">내용</option>
        <option th:value="tw" th:selected="${ph.pgvo.type eq 'tw' ? 'true' : 'false' }">제목+작가</option>
        <option th:value="tc" th:selected="${ph.pgvo.type eq 'tc' ? 'true' : 'false' }">제목+내용</option>
        <option th:value="wc" th:selected="${ph.pgvo.type eq 'wc' ? 'true' : 'false' }">작가+내용</option>
      </select>

      <input class="form-control me-2" name="keyword" type="search" placeholder="검색어를 입력해주세요" th:value="${ph.pgvo.keyword}"
             style="width: 750px;">
      <input type="hidden" name="pageNo" value="1">
      <input type="hidden" name="qty" th:value="${ph.pgvo.qty }" id="qtyInput"> <!-- qty 값을 숨김 입력 필드로 추가 -->

      <button type="submit" class="btn btn-success position-relative">
        Search
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    [[${ph.totalCount }]]
                    <span class="visually-hidden">unread messages</span>
                </span>
      </button>
    </form>
  </div>

  <table class="table table-hover" style="text-align: center;">
    <thead>
      <tr>
        <th scope="col" style="width: 10%;">No.</th>
        <th scope="col" style="width: 40%;">Title</th>
        <th scope="col" style="width: 20%;">Writer</th>
        <th scope="col" style="width: 30%;">RegDate</th>
      </tr>
      </thead>
      <tbody>
        <tr th:each="bvo:${list}">
          <td>[[${bvo.bno}]]</td>
          <td><a th:href="@{/board/detail(bno=${bvo.bno})}">[[${bvo.title}]]</a></td>
          <td>[[${bvo.writer}]]</td>
          <td>[[${bvo.regDate}]]</td>
        </tr>
    </tbody>
  </table>

  <!--[[${ph}]]-->
  <!--/* ${ } => jsp EL 방식 => 타입리프 th: 사용 */-->

  <!--/* th:classappend : 동적 클래스 추가 */-->
  <!--/* 페이지네이션 라인 */-->
  <nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center">
      <li class="page-item" th:classappend="${ph.prev eq false ? 'disabled' : ''}">
        <a class="page-link" th:href="@{/board/list(pageNo=${ph.startPage-1}, qty=10, type=${ph.pgvo.type}, keyword=${ph.pgvo.keyword})}" aria-label="Previous">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>
      <!--/* ${#numbers.sequence(from,to)} */-->
      <th:block th:each="i : ${#numbers.sequence(ph.startPage, ph.endPage)}">
        <li class="page-item" th:classappend="${ph.pgvo.pageNo eq i ? 'active' : ''}">
          <a class="page-link" th:href="@{/board/list(pageNo=${i}, qty=10)}">[[${i}]]</a>
        </li>
      </th:block>
      <li class="page-item" th:classappend="${ph.next eq false ? 'disabled' : ''}">
        <a class="page-link" th:href="@{/board/list(pageNo=${ph.endPage+1}, qty=10, type=${ph.pgvo.type}, keyword=${ph.pgvo.keyword})}" aria-label="Next">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
    </ul>
  </nav>

</div>

<!-- 보여줄 개수 선택 (qty) -->
<!--<select class="form-select" name="qty" onchange="updateQty()">
  <option th:value="10" th:selected="${ph.pgvo.qty == 10 ? 'selected' : '' }">10개씩</option>
  <option th:value="5" th:selected="${ph.pgvo.qty == 5 ? 'selected' : '' }">5개씩</option>
  <option th:value="15" th:selected="${ph.pgvo.qty == 15 ? 'selected' : '' }">15개씩</option>
  <option th:value="20" th:selected="${ph.pgvo.qty == 20 ? 'selected' : '' }">20개씩</option>
</select>
<script>
  // qty가 변경되면 자동으로 폼을 제출
  function updateQty() {
      var qty = document.querySelector('select[name="qty"]').value;
      document.getElementById('qtyInput').value = qty; // qty 값을 숨김 입력 필드에 설정
      document.getElementById('searchForm').submit(); // 폼을 자동 제출
  }
</script>-->
